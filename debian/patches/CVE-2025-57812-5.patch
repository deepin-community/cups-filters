From 5122052dd8f06949242099401c59f6c3b14e61c3 Mon Sep 17 00:00:00 2001
From: Till Kamppeter <till.kamppeter@gmail.com>
Date: Mon, 10 Nov 2025 18:57:07 +0100
Subject: [PATCH] Reject images with vertical scanlines

5.  fix for CVE-2025-57812
---
 cupsfilters/image-tiff.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/cupsfilters/image-tiff.c b/cupsfilters/image-tiff.c
index 04ec0719a..e9a78d3d5 100644
--- a/cupsfilters/image-tiff.c
+++ b/cupsfilters/image-tiff.c
@@ -303,6 +303,14 @@ _cupsImageReadTIFF(
         break;
   }
 
+  if (orientation >= ORIENTATION_LEFTTOP)
+  {
+    fputs("ERROR: TIFF files with vertical scanlines are not supported!\n", stderr);
+    TIFFClose(tif);
+    fclose(fp);
+    return (-1);
+  }
+
   switch (orientation)
   {
     case ORIENTATION_TOPRIGHT :
