From 5e5f1c5d46a043c57cbbe6e043aa95896d9c40fa Mon Sep 17 00:00:00 2001
From: Till Kamppeter <till.kamppeter@gmail.com>
Date: Mon, 10 Nov 2025 18:42:52 +0100
Subject: [PATCH] Fix heap-buffer overflow write in cfImageLut

1. fix for CVE-2025-57812
---
 cupsfilters/image-tiff.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/cupsfilters/image-tiff.c b/cupsfilters/image-tiff.c
index 5fe89071c..5eb29abc3 100644
--- a/cupsfilters/image-tiff.c
+++ b/cupsfilters/image-tiff.c
@@ -1469,7 +1469,7 @@ _cupsImageReadTIFF(
 	      }
 
 	      if (lut)
-	        cupsImageLut(out, img->xsize * 3, lut);
+	        cupsImageLut(out, img->xsize * bpp, lut);
 
               _cupsImagePutRow(img, 0, y, img->xsize, out);
             }
